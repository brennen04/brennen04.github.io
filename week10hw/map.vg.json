{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",

  "params": [
    {
      "name": "YearParam",
      "value": 2024,
      "bind": { "input": "select", "options": [2023, 2024], "labels": ["2023","2024"], "name": "Year: " }
    }
  ],

  "vconcat": [
    {
      "width": 480,
      "height": 470,
      "title": "Job vacancies by state/territory (Australia)",
      "projection": { "type": "mercator", "center": [134.5, -28], "scale": 600, "translate": [245, 245] },
      "layer": [
        { "data": { "graticule": { "step": [10, 10] } }, "mark": { "type": "geoshape", "stroke": "#b8c2cc", "strokeWidth": 0.6, "fill": null } },
        {
          "data": { "url": "https://cdn.jsdelivr.net/gh/rowanhogan/australian-states@master/states.geojson", "format": { "type": "json", "property": "features" } },
          "transform": [
            {
              "lookup": "properties.STATE_NAME",
              "from": {
                "data": { "values": [
                  { "state": "Northern Territory", "vacancies": 5800 },
                  { "state": "Australian Capital Territory", "vacancies": 7800 },
                  { "state": "Tasmania", "vacancies": 5500 },
                  { "state": "South Australia", "vacancies": 22000 },
                  { "state": "Western Australia", "vacancies": 40600 },
                  { "state": "Queensland", "vacancies": 71400 },
                  { "state": "Victoria", "vacancies": 74800 },
                  { "state": "New South Wales", "vacancies": 98100 }
                ] },
                "key": "state",
                "fields": ["vacancies"]
              }
            }
          ],
          "mark": { "type": "geoshape", "stroke": "white" },
          "encoding": {
            "shape": { "field": "geometry", "type": "geojson" },
            "color": { "field": "vacancies", "type": "quantitative", "title": "Job vacancies", "scale": { "scheme": "blues" }, "legend": { "format": ",d" } },
            "tooltip": [
              { "field": "properties.STATE_NAME", "title": "State/Territory" },
              { "field": "vacancies", "type": "quantitative", "title": "Job Vacancies", "format": ",d" }
            ]
          }
        },
        {
          "data": { "url": "https://cdn.jsdelivr.net/gh/rowanhogan/australian-states@master/states.geojson", "format": { "type": "json", "property": "features" } },
          "mark": { "type": "geoshape", "fill": null, "stroke": "#ffffff", "strokeWidth": 0.8, "strokeOpacity": 0.8 },
          "encoding": { "shape": { "field": "geometry", "type": "geojson" } }
        }
      ]
    },

    {
      "width": 480,
      "height": 470,
      "title": "International Undergraduate Student Full-time Employment% by Course Area, Australia (2023 vs 2024)",
      "data": { "url": "data/week10hwdataset.csv" },

      "transform": [
        { "fold": ["Full-time employment 2023", "Full-time employment 2024"], "as": ["key", "value"] },
        { "calculate": "parseInt(replace(datum.key, 'Full-time employment ', ''))", "as": "Year" },
        { "calculate": "(isValid(datum['Course Area']) && datum['Course Area']!=null) ? datum['Course Area'] : datum['Unnamed: 0']", "as": "Course" },
        { "filter": "datum.Year === YearParam" }
      ],

      "mark": "bar",

      "encoding": {
        "x": {
        "field": "Course",
        "type": "nominal",
        "title": "Course Area",
        "sort": "-y",
        "axis": {
            "labelAngle": -35,        
            "labelAlign": "right",    
            "labelBaseline": "middle",
            "labelLimit": 180,       
            "labelPadding": 4
        },
        "scale": {
    "paddingInner": 0.3,  
    "paddingOuter": 0.2 
  }
},
        "y": { "field": "value", "type": "quantitative", "title": "Full-time employment %", "axis": { "format": ",d" } },
        "tooltip": [
          { "field": "Course", "title": "Course Area" },
          { "field": "Year", "type": "ordinal" },
          { "field": "value", "title": "Full-time employment", "format": ",d" }
        ]
      }
    }
  ],
  "spacing": 30,
  "resolve": { "scale": { "color": "independent" } }
}
